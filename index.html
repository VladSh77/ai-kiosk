<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Karkandaki - Ormia≈Ñska Restauracja</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(145deg, #6B2E0E 0%, #8B4513 70%, #A0522D 100%);
            color: #FFF8DC;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            -webkit-tap-highlight-color: transparent;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            background: rgba(0, 0, 0, 0.65);
            backdrop-filter: blur(10px);
            border-radius: 60px 60px 40px 40px;
            padding: 30px 20px;
            box-shadow: 0 25px 50px -8px rgba(0,0,0,0.6);
            border: 2px solid #DAA520;
        }
        
        h1 {
            font-size: clamp(2.5rem, 10vw, 5rem);
            color: #FFD700;
            text-shadow: 4px 4px 0 #5A2E0E;
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-align: center;
        }
        
        .subtitle {
            font-size: clamp(1rem, 4vw, 1.5rem);
            color: #FFE4B5;
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        /* G≈Å√ìWNY PRZYCISK - DU≈ªY, OKRƒÑG≈ÅY, DOTYKOWY */
        .mic-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            position: relative;
        }
        
        .mic-button {
            width: min(250px, 60vw);
            height: min(250px, 60vw);
            border-radius: 50%;
            background: linear-gradient(145deg, #FFD700, #FFA500);
            border: 6px solid #FFF8DC;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5), 0 0 0 8px rgba(218,165,32,0.3);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            font-size: clamp(4rem, 15vw, 7rem);
            color: #5A2E0E;
            line-height: 1;
            padding-bottom: 10px;
            position: relative;
            z-index: 10;
        }
        
        .mic-button span {
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            margin-top: 10px;
            color: #5A2E0E;
            font-weight: bold;
            background: rgba(255,255,255,0.3);
            padding: 8px 20px;
            border-radius: 40px;
        }
        
        .mic-button.active {
            background: linear-gradient(145deg, #FF4444, #CC0000);
            color: white;
            box-shadow: 0 0 30px #FF4444, 0 0 60px #FF8888;
            transform: scale(1.02);
            border-color: #FFD700;
        }
        
        .mic-button.active span {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .mic-button:active {
            transform: scale(0.98);
        }
        
        /* Animacja pulsowania podczas nas≈Çuchiwania */
        .mic-button.listening {
            animation: pulse 1.8s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7), 0 0 0 10px rgba(255, 68, 68, 0.3); }
            70% { box-shadow: 0 0 0 20px rgba(255, 68, 68, 0), 0 0 0 30px rgba(255, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0), 0 0 0 0 rgba(255, 68, 68, 0); }
        }
        
        /* Panel powitalny AI */
        .welcome-panel {
            background: rgba(101, 67, 33, 0.7);
            border-radius: 50px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #DAA520;
            backdrop-filter: blur(5px);
            text-align: center;
        }
        
        .welcome-text {
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            line-height: 1.6;
            color: #FFEBCD;
        }
        
        .ai-avatar {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        /* Obszar rozmowy */
        .conversation-area {
            background: rgba(70, 40, 20, 0.8);
            border-radius: 40px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #DAA520;
        }
        
        .message {
            margin: 15px 0;
            padding: 15px 20px;
            border-radius: 30px;
            max-width: 85%;
            word-wrap: break-word;
            animation: fadeIn 0.3s;
            font-size: clamp(1rem, 3.5vw, 1.2rem);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background: #8B4513;
            border: 2px solid #DAA520;
            margin-left: auto;
            border-radius: 30px 30px 10px 30px;
            text-align: right;
        }
        
        .bot-message {
            background: #2A6B2A;
            border: 2px solid #DAA520;
            margin-right: auto;
            border-radius: 30px 30px 30px 10px;
        }
        
        .system-message {
            background: #5A4A3A;
            border: 1px solid #DAA520;
            margin: 10px auto;
            text-align: center;
            max-width: 90%;
            font-style: italic;
            opacity: 0.9;
        }
        
        .timestamp {
            font-size: 0.7rem;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        /* Menu w siatce */
        .menu-preview {
            margin: 30px 0;
        }
        
        .menu-preview h3 {
            color: #FFD700;
            font-size: clamp(1.3rem, 5vw, 2rem);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .menu-item {
            background: rgba(139, 69, 19, 0.6);
            border: 2px solid #DAA520;
            border-radius: 30px;
            padding: 15px 10px;
            text-align: center;
            transition: all 0.2s;
            backdrop-filter: blur(2px);
        }
        
        .menu-item:active {
            transform: scale(0.97);
            background: rgba(160, 82, 45, 0.8);
        }
        
        .menu-item h4 {
            color: #FFD700;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            margin-bottom: 5px;
        }
        
        .menu-price {
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            font-weight: bold;
            color: #FFD700;
        }
        
        .menu-desc {
            font-size: 0.8rem;
            opacity: 0.8;
            margin: 5px 0;
        }
        
        /* Panel informacyjny */
        .info-footer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 15px;
            margin-top: 30px;
            padding: 20px;
            background: rgba(60, 40, 20, 0.6);
            border-radius: 40px;
            border: 1px solid #DAA520;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-item .icon {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .info-item .label {
            font-weight: bold;
            color: #FFD700;
            font-size: 1rem;
        }
        
        .info-item .value {
            font-size: 0.9rem;
        }
        
        .phone-number {
            font-size: clamp(1.3rem, 5vw, 2rem);
            color: #FFD700;
            text-align: center;
            margin: 20px 0 10px;
            letter-spacing: 2px;
        }
        
        /* Stopka */
        .footer-note {
            text-align: center;
            margin-top: 20px;
            font-size: 0.8rem;
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè∫ KARKANDAKI</h1>
        <div class="subtitle">Tradycyjna kuchnia ormia≈Ñska</div>
        
        <!-- G≈Å√ìWNY PRZYCISK (OKRƒÑG≈ÅY, DU≈ªY) -->
        <div class="mic-container">
            <div class="mic-button" id="mainButton" onclick="handleMainButton()">
                üé§
                <span id="buttonText">Dotknij by m√≥wiƒá</span>
            </div>
        </div>
        
        <!-- Panel powitalny AI -->
        <div class="welcome-panel" id="welcomePanel">
            <div class="ai-avatar">ü§µ</div>
            <div class="welcome-text" id="welcomeMessage">
                Witam w restauracji Karkandaki!<br>
                Oto nasze specja≈Çy kuchni ormia≈Ñskiej.<br>
                Powiedz czego szukasz, a chƒôtnie doradzƒô.
            </div>
        </div>
        
        <!-- Obszar rozmowy (ukryty na poczƒÖtku, pojawia siƒô po pierwszej interakcji) -->
        <div class="conversation-area" id="conversationArea" style="display: none;">
            <div id="conversation"></div>
        </div>
        
        <!-- Menu -->
        <div class="menu-preview">
            <h3>üçΩÔ∏è NASZE DANIA</h3>
            <div class="menu-grid" id="menuGrid"></div>
        </div>
        
        <!-- Informacje -->
        <div class="info-footer">
            <div class="info-item">
                <div class="icon">üïê</div>
                <div class="label">Godziny</div>
                <div class="value">8:00 - 22:00</div>
            </div>
            <div class="info-item">
                <div class="icon">üìç</div>
                <div class="label">Adres</div>
                <div class="value">Kolejowa 41</div>
            </div>
            <div class="info-item">
                <div class="icon">üöö</div>
                <div class="label">Dow√≥z</div>
                <div class="value">10 z≈Ç</div>
            </div>
            <div class="info-item">
                <div class="icon">ü•£</div>
                <div class="label">Sosy</div>
                <div class="value">w≈Çasne</div>
            </div>
        </div>
        
        <div class="phone-number">üìû 530 324 239</div>
        <div class="footer-note">Dotknij mikrofon i m√≥w po polsku ‚Ä¢ AI Kiosk v2.0</div>
    </div>

    <script>
        // ==================== BAZA WIEDZY AI ====================
        // TO JEST OSOBNY PLIK Z DANYMI (mo≈ºna przenie≈õƒá do osobnego JSON)
        const AI_KNOWLEDGE = {
            // Powitanie
            welcome: {
                greeting: "Witam w restauracji Karkandaki! Specjalizujemy siƒô w tradycyjnej kuchni ormia≈Ñskiej. Naszym flagowym daniem jest Karkandak - wyjƒÖtkowa przekƒÖska z ciasta z r√≥≈ºnymi nadzieniami. Mamy wersje wytrawne i s≈Çodkie. Co mogƒô poleciƒá?",
                recommend: "Polecam dzi≈õ Karkandak ormia≈Ñski z ziemniakami i zio≈Çami oraz naszƒÖ domowƒÖ lemoniadƒô."
            },
            
            // Produkty (dania)
            products: [
                {
                    id: "ormianski",
                    name: "Karkandak ormia≈Ñski",
                    price: 28,
                    category: "wytrawne",
                    description: "Tradycyjny ormia≈Ñski przysmak - delikatne ciasto nadziewane ziemniakami z zio≈Çami i przyprawami. Podawany z sosem czosnkowym.",
                    ingredients: ["ciasto", "ziemniaki", "zio≈Ça", "czosnek", "oliwa"],
                    recipe: "Ciasto przygotowujemy wed≈Çug starej ormia≈Ñskiej receptury, cienko wa≈Çkujemy i nadziewamy farszem z ziemniak√≥w, cebuli, czosnku i ≈õwie≈ºych zi√≥≈Ç. Zapiekamy do z≈Çotego koloru.",
                    allergens: ["gluten", "nabia≈Ç"],
                    promotions: "W poniedzia≈Çki -15% na wszystkie dania ormia≈Ñskie"
                },
                {
                    id: "kaukaski",
                    name: "Karkandak kaukaski",
                    price: 26,
                    category: "wytrawne",
                    description: "Inspirowany kuchniƒÖ Kaukazu - z soczewicƒÖ, kolendrƒÖ i pikantnymi przyprawami.",
                    ingredients: ["ciasto", "soczewica", "kolendra", "papryka", "czosnek"],
                    recipe: "Soczewicƒô gotujemy z przyprawami, mieszamy z karmelizowanƒÖ cebulƒÖ, zawijamy w ciasto i pieczemy na chrupko.",
                    allergens: ["gluten"],
                    promotions: null
                },
                {
                    id: "mieso",
                    name: "Karkandak z miƒôsem",
                    price: 35,
                    category: "wytrawne",
                    description: "Soczysta wo≈Çowina duszona z cebulƒÖ i przyprawami w cie≈õcie.",
                    ingredients: ["ciasto", "wo≈Çowina", "cebula", "pieprz", "majeranek"],
                    recipe: "Miƒôso dusimy powoli z przyprawami, nastƒôpnie zawijamy w ciasto i zapiekamy. Podajemy z sosem miƒôsnym.",
                    allergens: ["gluten"],
                    promotions: "Weekendowa promocja: drugi Karkandak z miƒôsem -50%"
                },
                {
                    id: "kapusta",
                    name: "Karkandak z kapustƒÖ",
                    price: 24,
                    category: "wytrawne",
                    description: "Z duszona kapustƒÖ i grzybami - wegetaria≈Ñska wersja.",
                    ingredients: ["ciasto", "kapusta", "grzyby", "cebula", "koper"],
                    recipe: "Kapustƒô dusimy z grzybami le≈õnymi, doprawiamy, zawijamy w ciasto i pieczemy.",
                    allergens: ["gluten"],
                    promotions: null
                },
                {
                    id: "grzyby",
                    name: "Karkandak z grzybami",
                    price: 29,
                    category: "wytrawne",
                    description: "Le≈õne grzyby w kremowym sosie w chrupiƒÖcym cie≈õcie.",
                    ingredients: ["ciasto", "grzyby", "≈õmietana", "cebula", "tymianek"],
                    recipe: "Grzyby dusimy z cebulƒÖ, dodajemy ≈õmietanƒô i zio≈Ça. Nadzienie zawijamy w ciasto i zapiekamy.",
                    allergens: ["gluten", "nabia≈Ç"],
                    promotions: null
                },
                {
                    id: "nutella",
                    name: "Karkandak z nutellƒÖ",
                    price: 22,
                    category: "s≈Çodkie",
                    description: "S≈Çodka wersja z kremem czekoladowym - idealna na deser.",
                    ingredients: ["ciasto", "nutella", "orzechy"],
                    recipe: "Ciasto sma≈ºymy na z≈Çoto, nadziewamy nutellƒÖ i posypujemy orzechami.",
                    allergens: ["gluten", "orzechy", "mleko"],
                    promotions: "Deserowy zestaw: Karkandak z nutellƒÖ + lemoniada = 35 z≈Ç"
                },
                {
                    id: "twarog",
                    name: "Karkandak z twarogiem",
                    price: 24,
                    category: "s≈Çodkie",
                    description: "Z twarogiem i miodem - tradycyjny ormia≈Ñski deser.",
                    ingredients: ["ciasto", "twar√≥g", "mi√≥d", "cynamon"],
                    recipe: "Twar√≥g mieszamy z miodem i cynamonem, zawijamy w ciasto, zapiekamy. Podajemy polane miodem.",
                    allergens: ["gluten", "nabia≈Ç"],
                    promotions: null
                }
            ],
            
            // Informacje o restauracji
            restaurant: {
                name: "Karkandaki",
                cuisine: "ormia≈Ñska",
                hours: "8:00 - 22:00 codziennie",
                address: "ul. Kolejowa 41, 63-400 Ostr√≥w Wielkopolski",
                phone: "530 324 239",
                delivery: "Dow√≥z 10 z≈Ç (zam√≥wienia telefoniczne)",
                payment: "Got√≥wka, karta, blik",
                website: "www.karkandaki.pl",
                founded: "Za≈Ço≈ºona w 2018 roku przez rodzinƒô z Armenii",
                about: "Karkandaki to rodzinna restauracja serwujƒÖca autentycznƒÖ kuchniƒô ormia≈ÑskƒÖ. Naszym celem jest dzielenie siƒô bogactwem smak√≥w Kaukazu. Wszystkie potrawy przygotowujemy wed≈Çug tradycyjnych receptur."
            },
            
            // Promocje i wydarzenia
            promotions: [
                {
                    id: "promo1",
                    title: "Poniedzia≈Çek z OrmeniƒÖ",
                    description: "W ka≈ºdy poniedzia≈Çek 15% zni≈ºki na wszystkie dania ormia≈Ñskie"
                },
                {
                    id: "promo2",
                    title: "Weekendowy duet",
                    description: "Kup drugi Karkandak z miƒôsem 50% taniej w soboty i niedziele"
                },
                {
                    id: "promo3",
                    title: "Deserowy zestaw",
                    description: "Karkandak z nutellƒÖ + lemoniada = 35 z≈Ç"
                }
            ],
            
            // Sugestie i rekomendacje
            suggestions: {
                popular: "Najczƒô≈õciej wybierany jest Karkandak ormia≈Ñski i Karkandak z miƒôsem",
                forTwo: "Dla pary polecamy zestaw: Karkandak ormia≈Ñski, Karkandak z miƒôsem, lemoniada i deser",
                vegetarian: "Dla wegetarian polecamy Karkandak z kapustƒÖ lub z grzybami",
                sweet: "Dla mi≈Ço≈õnik√≥w s≈Çodko≈õci mamy Karkandak z nutellƒÖ lub z twarogiem i miodem"
            },
            
            // Odpowiedzi na typowe pytania
            faq: {
                opening_hours: "Jeste≈õmy czynni codziennie od 8:00 do 22:00. Zapraszamy!",
                address: "Nasz adres: ul. Kolejowa 41, Ostr√≥w Wielkopolski. To w centrum miasta, blisko dworca.",
                delivery: "Oferujemy dow√≥z w cenie 10 z≈Ç na terenie miasta. Zam√≥wienia przyjmujemy telefonicznie: 530 324 239.",
                parking: "Przed restauracjƒÖ jest bezp≈Çatny parking dla go≈õci.",
                reservations: "Nie prowadzimy rezerwacji stolik√≥w - obowiƒÖzuje kolejno≈õƒá przyj≈õcia. W razie potrzeby zapraszamy do kontaktu telefonicznego.",
                payment: "Akceptujemy p≈Çatno≈õci got√≥wkƒÖ, kartƒÖ oraz blikiem.",
                ingredients: "Wszystkie sk≈Çadniki sƒÖ ≈õwie≈ºe, pochodzƒÖ od lokalnych dostawc√≥w. W razie alergii prosimy pytaƒá obs≈Çugƒô o szczeg√≥≈Çy.",
                gluten_free: "Niestety nie posiadamy wersji bezglutenowych, poniewa≈º wszystkie nasze ciasta zawierajƒÖ gluten.",
                vegan: "Mamy dania wegetaria≈Ñskie (z kapustƒÖ, grzybami), ale nie wega≈Ñskie - zawierajƒÖ nabia≈Ç."
            }
        };

        // ==================== STAN APLIKACJI ====================
        let isListening = false;
        let isFirstInteraction = true;
        let conversationVisible = false;
        let mediaRecorder = null;
        let audioChunks = [];
        
        // Elementy DOM
        const mainButton = document.getElementById('mainButton');
        const buttonText = document.getElementById('buttonText');
        const welcomePanel = document.getElementById('welcomePanel');
        const welcomeMessage = document.getElementById('welcomeMessage');
        const conversationArea = document.getElementById('conversationArea');
        const conversation = document.getElementById('conversation');
        const menuGrid = document.getElementById('menuGrid');
        
        // Inicjalizacja menu z bazy wiedzy
        function renderMenu() {
            const menuHtml = AI_KNOWLEDGE.products.map(product => `
                <div class="menu-item" onclick="askAboutProduct('${product.id}')">
                    <h4>${product.name}</h4>
                    <div class="menu-price">${product.price} z≈Ç</div>
                    <div class="menu-desc">${product.description.substring(0, 40)}...</div>
                </div>
            `).join('');
            menuGrid.innerHTML = menuHtml;
        }
        
        // Funkcja do zadawania pyta≈Ñ o produkt
        function askAboutProduct(productId) {
            const product = AI_KNOWLEDGE.products.find(p => p.id === productId);
            if (product) {
                addMessage('user', `Opowiedz o ${product.name}`);
                
                // AI odpowiada szczeg√≥≈Çowo
                setTimeout(() => {
                    const response = `${product.name} ‚Äì ${product.description} Sk≈Çadniki: ${product.ingredients.join(', ')}. ${product.recipe} Cena: ${product.price} z≈Ç. ${product.promotions ? 'Promocja: ' + product.promotions : ''}`;
                    addMessage('bot', response);
                }, 600);
            }
        }
        
        // Funkcja obs≈Çugi g≈Ç√≥wnego przycisku
        async function handleMainButton() {
            if (!isListening) {
                // Rozpocznij nagrywanie
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];
                    
                    mediaRecorder.ondataavailable = event => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        await processAudio(audioBlob);
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    mediaRecorder.start();
                    isListening = true;
                    
                    // Zmiana wyglƒÖdu przycisku
                    mainButton.classList.add('active', 'listening');
                    buttonText.innerText = 'S≈Çucham...';
                    
                    // Przy pierwszym u≈ºyciu - zmiana powitania
                    if (isFirstInteraction) {
                        welcomeMessage.innerHTML = AI_KNOWLEDGE.welcome.greeting;
                        isFirstInteraction = false;
                    }
                    
                } catch (err) {
                    console.error('B≈ÇƒÖd mikrofonu:', err);
                    addSystemMessage('‚ùå Brak dostƒôpu do mikrofonu');
                }
            } else {
                // Zako≈Ñcz nagrywanie
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                isListening = false;
                mainButton.classList.remove('active', 'listening');
                buttonText.innerText = 'Dotknij by m√≥wiƒá';
            }
        }
        
        // Przetwarzanie audio (symulacja rozpoznawania)
        async function processAudio(audioBlob) {
            // Symulacja op√≥≈∫nienia sieciowego
            addSystemMessage('‚è≥ Rozpoznajƒô mowƒô...');
            
            // W rzeczywistej aplikacji tu by≈Çoby wysy≈Çanie do backendu
            // Na razie symulujemy rozpoznawanie po 1.5s
            setTimeout(() => {
                // Symulowane rozpoznane teksty (dla test√≥w)
                const simulatedQueries = [
                    "co polecacie",
                    "Karkandak ormia≈Ñski",
                    "godziny otwarcia",
                    "czy macie dow√≥z",
                    "adres restauracji",
                    "promocje",
                    "Karkandak z miƒôsem",
                    "co≈õ s≈Çodkiego",
                    "dla wegetarian"
                ];
                
                const randomQuery = simulatedQueries[Math.floor(Math.random() * simulatedQueries.length)];
                
                // Dodajemy zapytanie u≈ºytkownika do rozmowy
                addMessage('user', randomQuery);
                
                // Generujemy odpowied≈∫ AI na podstawie bazy wiedzy
                const response = generateAIResponse(randomQuery);
                
                // Dodajemy odpowied≈∫ AI
                setTimeout(() => {
                    addMessage('bot', response);
                }, 500);
                
                // Pokazujemy obszar rozmowy je≈õli niewidoczny
                if (!conversationVisible) {
                    conversationArea.style.display = 'block';
                    conversationVisible = true;
                }
                
                addSystemMessage('Gotowy do nastƒôpnego pytania');
            }, 1500);
        }
        
        // Generator odpowiedzi AI na podstawie bazy wiedzy
        function generateAIResponse(query) {
            const q = query.toLowerCase();
            
            // Powitanie
            if (q.includes('dzie≈Ñ dobry') || q.includes('witam') || q.includes('cze≈õƒá')) {
                return "Dzie≈Ñ dobry! Witam w Karkandaki. Czym mogƒô s≈Çu≈ºyƒá?";
            }
            
            // Polecenia og√≥lne
            if (q.includes('polecacie') || q.includes('co dobre') || q.includes('specja≈Çy')) {
                return AI_KNOWLEDGE.welcome.recommend + " " + AI_KNOWLEDGE.suggestions.popular;
            }
            
            // Godziny otwarcia
            if (q.includes('godziny') || q.includes('otwarcia') || q.includes('czynne')) {
                return AI_KNOWLEDGE.faq.opening_hours;
            }
            
            // Adres
            if (q.includes('adres') || q.includes('gdzie') || q.includes('znajduje')) {
                return AI_KNOWLEDGE.faq.address;
            }
            
            // Dow√≥z/dostawa
            if (q.includes('dow√≥z') || q.includes('dostawa') || q.includes('transport')) {
                return AI_KNOWLEDGE.faq.delivery;
            }
            
            // Promocje
            if (q.includes('promocje') || q.includes('zni≈ºki') || q.includes('okazje')) {
                return "Nasze aktualne promocje: " + AI_KNOWLEDGE.promotions.map(p => p.description).join('. ');
            }
            
            // Dla wegetarian
            if (q.includes('wegetaria') || q.includes('bez miƒôsa')) {
                return AI_KNOWLEDGE.suggestions.vegetarian;
            }
            
            // S≈Çodkie
            if (q.includes('s≈Çodkie') || q.includes('deser') || q.includes('na s≈Çodko')) {
                return AI_KNOWLEDGE.suggestions.sweet;
            }
            
            // Produkty po nazwie
            for (let product of AI_KNOWLEDGE.products) {
                if (q.includes(product.name.toLowerCase())) {
                    return `${product.name} ‚Äì ${product.description} Cena: ${product.price} z≈Ç. ${product.promotions ? 'Promocja: ' + product.promotions : ''}`;
                }
            }
            
            // P≈Çatno≈õci
            if (q.includes('p≈Çatno≈õƒá') || q.includes('karta') || q.includes('got√≥wka')) {
                return AI_KNOWLEDGE.faq.payment;
            }
            
            // Sk≈Çadniki/alergeny
            if (q.includes('sk≈Çadniki') || q.includes('alergeny') || q.includes('uczulenie')) {
                return "Wszystkie sk≈Çadniki sƒÖ ≈õwie≈ºe. Dla konkretnego dania zapytaj o jego nazwƒô, a podam pe≈ÇnƒÖ listƒô sk≈Çadnik√≥w. W razie alergii prosimy informowaƒá obs≈Çugƒô.";
            }
            
            // Domy≈õlna odpowied≈∫
            return "Przepraszam, nie zrozumia≈Çem. Proszƒô zapytaƒá obs≈Çugƒô restauracji lub spr√≥bowaƒá innego pytania. Mo≈ºesz zapytaƒá o menu, godziny otwarcia, adres, dow√≥z lub promocje.";
        }
        
        // Dodawanie wiadomo≈õci do rozmowy
        function addMessage(type, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type === 'user' ? 'user-message' : 'bot-message'}`;
            
            const prefix = type === 'user' ? 'üë§' : 'ü§ñ';
            const timestamp = new Date().toLocaleTimeString('pl-PL', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `${prefix} ${text}<div class="timestamp">${timestamp}</div>`;
            
            conversation.appendChild(messageDiv);
            conversationArea.scrollTop = conversationArea.scrollHeight;
            
            // Poka≈º obszar rozmowy je≈õli ukryty
            if (!conversationVisible) {
                conversationArea.style.display = 'block';
                conversationVisible = true;
            }
        }
        
        // Dodawanie wiadomo≈õci systemowej
        function addSystemMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message system-message';
            messageDiv.innerHTML = `‚ÑπÔ∏è ${text}`;
            conversation.appendChild(messageDiv);
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }
        
        // Inicjalizacja
        window.onload = function() {
            renderMenu();
            
            // Sprawd≈∫ wsparcie dla MediaRecorder
            if (!navigator.mediaDevices || !window.MediaRecorder) {
                mainButton.style.opacity = '0.5';
                mainButton.style.pointerEvents = 'none';
                buttonText.innerText = 'Brak wsparcia';
                addSystemMessage('‚ö†Ô∏è Twoja przeglƒÖdarka nie wspiera nagrywania audio. U≈ºyj Chrome, Firefox lub Edge na urzƒÖdzeniu mobilnym.');
            }
            
            // Dla urzƒÖdze≈Ñ dotykowych - usuwamy efekt podw√≥jnego klikniƒôcia
            document.addEventListener('touchstart', (e) => {
                if (e.target.closest('.menu-item')) {
                    e.preventDefault();
                }
            }, { passive: false });
        };
    </script>
</body>
</html>
